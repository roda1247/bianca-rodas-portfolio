---
title: "Portfolio"
author: "Bianca Rodas"
format: html
execute: 
  echo: false
  warning: false
  message: false
embed-resources: true
---


```{r}
#| label: setup
#| include: false

library(tidyverse)
library(dplyr)
library(viridis)
library(forcats)
```


## Data Description

Link: https://github.com/rfordatascience/tidytuesday/blob/main/data/2021/2021-01-26/readme.md

Description: The dataset is gathered through organized plastic waste audits and clean-up events on a global scale. This dataset holds record of the date, location, brand name, types of plastic, and quantity.

Questions:
1.How does branded plastics compare to unbranded plastics collected?  
2.Which brands were most associated with the plastic found?
3.Which plastics types were more commonly found? Which is the least?



## Data Cleaning


```{r}
#| label: Read-in-data

plastic <- read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2021/2021-01-26/plastics.csv", na = c("NA", "n/a", "unknown", "null", "NULL"))

```


```{r}
#| label: Clean-data

plastic <- plastic |> 
  mutate(brand= if_else(parent_company %in% c("Unbranded") | is.na(parent_company), "Unbranded", "Branded"))

top_companies <- plastic |> 
  filter(!parent_company %in% c("Grand Total", "Unbranded") & !is.na(parent_company)) |> 
  group_by(parent_company) |> 
  summarise(sum_grand_total = sum(grand_total)) |> 
  arrange(desc(sum_grand_total)) |> 
  slice_head(n = 10)

plastic <- plastic |>  
  pivot_longer(cols=c('hdpe', 'ldpe', 'o', 'pet', 'pp', 'ps', 'pvc'),
                    names_to='type',
                    values_to='count') |> 
  mutate(type= fct_reorder(type, count))
```


## Data Visualization

**Visualization 1**
```{r}
#| label: viz-1
#| fig-cap: "Figure. A bar graph that shows total plastic counts between plastics that was found branded (Purple bar) or unbranded (Yellow bar)."
#| fig-alt: "This is an alternative text for the first visualization"
#| fig-width: 6
#| fig-height: 4
#| fig-align: center


ggplot(plastic, aes(x=brand, y=grand_total, fill=brand))+
  geom_col()+
  theme_bw()+
  theme(legend.position = "none")+
  scale_fill_viridis(discrete=T,
                     option = "plasma",
                     begin=0.2, 
                     end=0.9)+
  labs(x="",
       y= "Plastic Counts",
       title ="Plastic Found with an Associated Brand")
```



**Visualization 2**
```{r}
#| label: viz-2
#| fig-cap: "Figure. This is a bar graph that shows the top ten companies associated with the plastic collected in the survey."
#| fig-alt: "This is an alternative text for the second visualization"
#| fig-width: 6
#| fig-height: 4
#| fig-align: center


ggplot(top_companies, aes(x=sum_grand_total, 
                              y=reorder(parent_company, (sum_grand_total))
                              , fill= parent_company))+
  geom_col(color="black",size=0.4)+
  theme_bw()+
  scale_fill_viridis_d(option = "plasma", guide = "colourbar")+
  labs(title="Companies identified during plastic collection",
       y= "",
       x="Total Trash Count")
```

**Visualization 3**
```{r}
#| label: viz-3
#| fig-cap: "Figure. Boxplot overlayed on a violin plot that shows the log counts of plastic types collected"
#| fig-alt: "This is an alternative text for the second visualization"
#| fig-width: 6
#| fig-height: 4
#| fig-align: center

ggplot(plastic, aes(y=count, x= type, fill=type))+
  geom_violin(show.legend=F)+
  geom_boxplot(show.legend=F,alpha=0.2)+
  theme_bw()+
  scale_y_log10()+
  scale_fill_viridis_d(option="plasma")+
  labs(x="Plastic Type",
       y="Log (Count)",
       title="Total Counts of Plastic Types Collected")
```



